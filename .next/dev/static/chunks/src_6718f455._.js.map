{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/schema.ts"],"sourcesContent":["import z from \"zod\";\n\nexport const loginSchema = z.object({\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n});\n\nexport type LoginData = z.infer<typeof loginSchema>;\n\nexport const registerSchema = z.object({\n    name: z.string().min(2, { message: \"Enter your name\" }),\n    username: z.string().min(3, { message: \"Username must be at least 3 characters\" }),\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n    confirmPassword: z.string().min(6, { message: \"Minimum 6 characters\" }),\n}).refine((v) => v.password === v.confirmPassword, {\n    path: [\"confirmPassword\"],\n    message: \"Passwords do not match\",\n});\n\nexport type RegisterData = z.infer<typeof registerSchema>;"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,cAAc,0JAAC,CAAC,MAAM,CAAC;IAChC,OAAO,0JAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AAClE;AAIO,MAAM,iBAAiB,0JAAC,CAAC,MAAM,CAAC;IACnC,MAAM,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAkB;IACrD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAyC;IAChF,OAAO,0JAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;IAC9D,iBAAiB,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AACzE,GAAG,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,EAAE,eAAe,EAAE;IAC/C,MAAM;QAAC;KAAkB;IACzB,SAAS;AACb"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/lib/action/auth-action.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\"use server\";\n\nimport { login, register } from \"../api/auth\";\nimport { setAuthToken, setUserData } from \"../cookie\";\n\nexport type AuthResponse<T = any> = {\n  success: boolean;\n  message: string;\n  data?: T;\n  user?: {\n    id: string;\n    email: string;\n    name?: string;\n    role: \"admin\" | \"user\";\n  };\n};\n\n// ===== HANDLE REGISTER =====\nexport const handleRegister = async (formData: any): Promise<AuthResponse> => {\n  try {\n    const res = await register(formData);\n\n    if (res.success) {\n      return {\n        success: true,\n        data: res.data,\n        message: res.message || \"Registration successful\",\n      };\n    }\n\n    return {\n      success: false,\n      message: res.message || \"Registration failed\",\n    };\n  } catch (error: any) {\n    console.error(\"Register error:\", error);\n\n    return {\n      success: false,\n      message: error.message || \"Registration failed\",\n    };\n  }\n};\n\n// ===== HANDLE LOGIN =====\nexport const handleLogin = async (formData: any): Promise<AuthResponse> => {\n  try {\n    const res = await login(formData);\n\n    console.log(\"Backend login response:\", res);\n\n    if (!res.success) {\n      return {\n        success: false,\n        message: res.message || \"Login failed\",\n      };\n    }\n\n    // ✅ token is in res.token (your backend response)\n    const token = res.token;\n\n    if (!token) {\n      return {\n        success: false,\n        message: \"Token missing from backend response\",\n      };\n    }\n\n    // ✅ Save token + user in cookies\n    await setAuthToken(token);\n    await setUserData(res.data);\n\n    return {\n      success: true,\n      data: res.data,\n      message: res.message || \"Login successful\",\n      user: {\n        id: res.data?._id,\n        email: res.data?.email,\n        name: res.data?.username || res.data?.name,\n        role: res.data?.role || \"user\",\n      },\n    };\n  } catch (error: any) {\n    console.error(\"Login error:\", error);\n\n    return {\n      success: false,\n      message: error.message || \"Login failed\",\n    };\n  }\n};\n"],"names":[],"mappings":";;;;;;;MAmBa,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/_components/RegisterForm.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\"use client\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { useState, useTransition } from \"react\";\n\nimport { RegisterData, registerSchema } from \"../schema\";\nimport { handleRegister } from \"@/lib/action/auth-action\";\n\nexport default function RegisterForm() {\n  const router = useRouter();\n  const [pending, startTransition] = useTransition();\n  const [error, setError] = useState(\"\");\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<RegisterData>({\n    resolver: zodResolver(registerSchema),\n    mode: \"onSubmit\",\n  });\n\n  const onSubmit = async (data: RegisterData) => {\n    try {\n      const res = await handleRegister(data);\n      if (!res.success) {\n        throw new Error(res.message || \"Registration failed\");\n      }\n      startTransition(() => {\n        router.push(\"/login\");\n      });\n    } catch (err: Error | any) {\n      setError(err.message || \"Registration failed\");\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n      {error && <p className=\"text-sm text-red-600\">{error}</p>}\n\n      {/* Name */}\n      <div className=\"space-y-1\">\n        <label className=\"text-sm font-medium\" htmlFor=\"name\">\n          Full name\n        </label>\n        <input\n          id=\"name\"\n          type=\"text\"\n          autoComplete=\"name\"\n          className=\"h-10 w-full rounded-md border border-black/10 dark:border-white/15 bg-background px-3 text-sm outline-none focus:border-foreground/40\"\n          {...register(\"name\")}\n          placeholder=\"Shreesha Shrestha\"\n        />\n        {errors.name && (\n          <p className=\"text-xs text-red-600\">{errors.name.message}</p>\n        )}\n      </div>\n\n      {/* Username */}\n      <div className=\"space-y-1\">\n        <label className=\"text-sm font-medium\" htmlFor=\"username\">\n          Username\n        </label>\n        <input\n          id=\"username\"\n          type=\"text\"\n          autoComplete=\"username\"\n          className=\"h-10 w-full rounded-md border border-black/10 dark:border-white/15 bg-background px-3 text-sm outline-none focus:border-foreground/40\"\n          {...register(\"username\")}\n          placeholder=\"shreesha123\"\n        />\n        {errors.username && (\n          <p className=\"text-xs text-red-600\">{errors.username.message}</p>\n        )}\n      </div>\n\n      {/* Email */}\n      <div className=\"space-y-1\">\n        <label className=\"text-sm font-medium\" htmlFor=\"email\">\n          Email\n        </label>\n        <input\n          id=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          className=\"h-10 w-full rounded-md border border-black/10 dark:border-white/15 bg-background px-3 text-sm outline-none focus:border-foreground/40\"\n          {...register(\"email\")}\n          placeholder=\"shreesha@example.com\"\n        />\n        {errors.email && (\n          <p className=\"text-xs text-red-600\">{errors.email.message}</p>\n        )}\n      </div>\n\n      {/* Password */}\n      <div className=\"space-y-1\">\n        <label className=\"text-sm font-medium\" htmlFor=\"password\">\n          Password\n        </label>\n        <input\n          id=\"password\"\n          type=\"password\"\n          autoComplete=\"new-password\"\n          className=\"h-10 w-full rounded-md border border-black/10 dark:border-white/15 bg-background px-3 text-sm outline-none focus:border-foreground/40\"\n          {...register(\"password\")}\n          placeholder=\"••••••\"\n        />\n        {errors.password && (\n          <p className=\"text-xs text-red-600\">{errors.password.message}</p>\n        )}\n      </div>\n\n      {/* Confirm Password */}\n      <div className=\"space-y-1\">\n        <label className=\"text-sm font-medium\" htmlFor=\"confirmPassword\">\n          Confirm password\n        </label>\n        <input\n          id=\"confirmPassword\"\n          type=\"password\"\n          autoComplete=\"new-password\"\n          className=\"h-10 w-full rounded-md border border-black/10 dark:border-white/15 bg-background px-3 text-sm outline-none focus:border-foreground/40\"\n          {...register(\"confirmPassword\")}\n          placeholder=\"••••••\"\n        />\n        {errors.confirmPassword && (\n          <p className=\"text-xs text-red-600\">\n            {errors.confirmPassword.message}\n          </p>\n        )}\n      </div>\n\n      {/* Submit */}\n      <button\n        type=\"submit\"\n        disabled={pending}\n        className=\"h-10 w-full rounded-md bg-pink-400 text-white text-sm font-semibold hover:bg-pink-500 disabled:opacity-60\"\n      >\n        {pending ? \"Registering...\" : \"Register\"}\n      </button>\n\n      {/* Login link */}\n      <div className=\"mt-1 text-center text-sm\">\n        Already have an account?{\" \"}\n        <Link href=\"/login\" className=\"font-semibold hover:underline\">\n          Log in\n        </Link>\n      </div>\n    </form>\n  );\n}"],"names":[],"mappings":"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"}}]
}