{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/dashboard/profile/page.tsx"],"sourcesContent":["\"use client\";\nimport { useState, useRef, ChangeEvent, useEffect } from \"react\";\n\ninterface ProfileData {\n  name: string;\n  email: string;\n  phone: string;\n  address: string;\n}\n\nexport default function ProfilePage() {\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n  const [profilePhoto, setProfilePhoto] = useState<string | null>(null);\n  const [profile, setProfile] = useState<ProfileData>({\n    name: \"\",\n    email: \"\",\n    phone: \"\",\n    address: \"\",\n  });\n  const [editedProfile, setEditedProfile] = useState<ProfileData>(profile);\n  const [loading, setLoading] = useState<boolean>(true);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    const fetchUserData = async () => {\n      try {\n        const userData = localStorage.getItem('user');\n\n        if (userData) {\n          const user = JSON.parse(userData);\n          const userProfile: ProfileData = {\n            name: user.name || user.fullName || \"\",\n            email: user.email || \"\",\n            phone: user.phone || \"\",\n            address: user.address || \"\",\n          };\n          setProfile(userProfile);\n          setEditedProfile(userProfile);\n\n          const userId = user.id || user._id;\n          if (userId) {\n            try {\n              const response = await fetch(`http://localhost:8000/api/upload/profile-image/${userId}`);\n              if (response.ok) {\n                const imageData = await response.json();\n                if (imageData.data && imageData.data.imageUrl) {\n                  const fullImageUrl = `http://localhost:8000${imageData.data.imageUrl}`;\n                  setProfilePhoto(fullImageUrl);\n                  localStorage.setItem('profilePhoto', fullImageUrl);\n                }\n              }\n            } catch (error) {\n              console.error(\"Error fetching profile image:\", error);\n            }\n          }\n        }\n\n      } catch (error) {\n        console.error(\"Error fetching user data:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchUserData();\n  }, []);\n\n  const handlePhotoUpload = async (e: ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const result = reader.result;\n        if (result && typeof result === 'string') {\n          setProfilePhoto(result);\n        }\n      };\n      reader.readAsDataURL(file);\n\n      try {\n        const userData = localStorage.getItem('user');\n        if (!userData) {\n          alert('User not logged in');\n          return;\n        }\n\n        const user = JSON.parse(userData);\n        const userId = user.id || user._id;\n\n        const formData = new FormData();\n        formData.append('image', file);\n        formData.append('userId', userId);\n\n        const response = await fetch('http://localhost:8000/api/upload/profile-image', {\n          method: 'POST',\n          body: formData,\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to upload photo');\n        }\n\n        const data = await response.json();\n        console.log('Photo uploaded successfully:', data);\n\n        if (data.data && data.data.imageUrl) {\n          const fullImageUrl = `http://localhost:8000${data.data.imageUrl}`;\n          setProfilePhoto(fullImageUrl);\n          localStorage.setItem('profilePhoto', fullImageUrl);\n        }\n\n        alert('Photo uploaded successfully!');\n\n      } catch (error) {\n        console.error('Error uploading photo:', error);\n        alert('Failed to upload photo to server');\n      }\n    }\n  };\n\n  const handleDeletePhoto = async () => {\n    try {\n      const userData = localStorage.getItem('user');\n      if (!userData) {\n        alert('User not logged in');\n        return;\n      }\n\n      const user = JSON.parse(userData);\n      const userId = user.id || user._id;\n\n      const response = await fetch(`http://localhost:8000/api/upload/profile-image/${userId}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete photo');\n      }\n\n      setProfilePhoto(null);\n      localStorage.removeItem('profilePhoto');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = \"\";\n      }\n\n      alert('Photo deleted successfully!');\n    } catch (error) {\n      console.error('Error deleting photo:', error);\n      alert('Failed to delete photo from server');\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      const userData = localStorage.getItem('user');\n      if (userData) {\n        const user = JSON.parse(userData);\n        const updatedUser = { ...user, ...editedProfile };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n      }\n\n      setProfile(editedProfile);\n      setIsEditing(false);\n      alert(\"Profile updated successfully!\");\n    } catch (error) {\n      console.error(\"Error saving profile:\", error);\n      alert(\"Failed to update profile\");\n    }\n  };\n\n  const handleCancel = () => {\n    setEditedProfile(profile);\n    setIsEditing(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-screen\">\n        <div className=\"text-xl text-gray-600\">Loading profile...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex justify-center pt-12 min-h-screen\">\n      <div className=\"w-full max-w-2xl px-4\">\n        <div className=\"bg-white rounded-xl p-8 border border-pink-100 shadow-lg\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-800\">Personal Information</h2>\n            {!isEditing && (\n              <button\n                onClick={() => setIsEditing(true)}\n                className=\"px-6 py-2 border border-pink-300 text-pink-600 rounded-full hover:bg-pink-50 transition\"\n              >\n                ‚úèÔ∏è Edit Profile\n              </button>\n            )}\n          </div>\n\n          <div className=\"mb-6 flex items-center gap-6\">\n            <div className=\"relative flex-shrink-0\">\n              <div className=\"w-24 h-24 rounded-full overflow-hidden border-3 border-pink-200 bg-gray-100 flex items-center justify-center\">\n                {profilePhoto ? (\n                  <img\n                    src={profilePhoto}\n                    alt=\"Profile\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <svg\n                    className=\"w-12 h-12 text-gray-400\"\n                    fill=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path d=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\" />\n                  </svg>\n                )}\n              </div>\n            </div>\n\n            {isEditing && (\n              <div className=\"flex gap-3\">\n                <input\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handlePhotoUpload}\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  id=\"photo-upload\"\n                />\n                <label\n                  htmlFor=\"photo-upload\"\n                  className=\"px-4 py-2 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition cursor-pointer font-medium text-sm\"\n                >\n                  üì∑ Upload Photo\n                </label>\n                {profilePhoto && (\n                  <button\n                    onClick={handleDeletePhoto}\n                    className=\"px-4 py-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition font-medium text-sm\"\n                  >\n                    üóëÔ∏è Delete Photo\n                  </button>\n                )}\n              </div>\n            )}\n          </div>\n\n          <div className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Full Name\n              </label>\n              {isEditing ? (\n                <input\n                  type=\"text\"\n                  value={editedProfile.name}\n                  onChange={(e) =>\n                    setEditedProfile({ ...editedProfile, name: e.target.value })\n                  }\n                  className=\"w-full px-4 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300\"\n                />\n              ) : (\n                <p className=\"text-gray-800 text-lg\">{profile.name}</p>\n              )}\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Email\n              </label>\n              {isEditing ? (\n                <input\n                  type=\"email\"\n                  value={editedProfile.email}\n                  onChange={(e) =>\n                    setEditedProfile({ ...editedProfile, email: e.target.value })\n                  }\n                  className=\"w-full px-4 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300\"\n                />\n              ) : (\n                <p className=\"text-gray-800 text-lg\">{profile.email}</p>\n              )}\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Phone Number\n              </label>\n              {isEditing ? (\n                <input\n                  type=\"tel\"\n                  value={editedProfile.phone}\n                  onChange={(e) =>\n                    setEditedProfile({ ...editedProfile, phone: e.target.value })\n                  }\n                  className=\"w-full px-4 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300\"\n                />\n              ) : (\n                <p className=\"text-gray-800 text-lg\">{profile.phone}</p>\n              )}\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Address\n              </label>\n              {isEditing ? (\n                <textarea\n                  value={editedProfile.address}\n                  onChange={(e) =>\n                    setEditedProfile({ ...editedProfile, address: e.target.value })\n                  }\n                  rows={2}\n                  className=\"w-full px-4 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300 resize-none\"\n                />\n              ) : (\n                <p className=\"text-gray-800 text-lg\">{profile.address}</p>\n              )}\n            </div>\n            {isEditing && (\n              <div className=\"flex gap-3 pt-4\">\n                <button\n                  onClick={handleSave}\n                  className=\"flex-1 py-3 px-6 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition font-semibold\"\n                >\n                  Save Changes\n                </button>\n                <button\n                  onClick={handleCancel}\n                  className=\"flex-1 py-3 px-6 border border-pink-300 text-pink-600 rounded-full hover:bg-pink-50 transition font-medium\"\n                >\n                  Cancel\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}