{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/schema.ts"],"sourcesContent":["import z from \"zod\";\n\nexport const loginSchema = z.object({\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n});\n\nexport type LoginData = z.infer<typeof loginSchema>;\n\nexport const registerSchema = z.object({\n    name: z.string().min(2, { message: \"Enter your name\" }),\n    username: z.string().min(3, { message: \"Username must be at least 3 characters\" }),\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n    confirmPassword: z.string().min(6, { message: \"Minimum 6 characters\" }),\n}).refine((v) => v.password === v.confirmPassword, {\n    path: [\"confirmPassword\"],\n    message: \"Passwords do not match\",\n});\n\nexport type RegisterData = z.infer<typeof registerSchema>;"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,cAAc,0JAAC,CAAC,MAAM,CAAC;IAChC,OAAO,0JAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AAClE;AAIO,MAAM,iBAAiB,0JAAC,CAAC,MAAM,CAAC;IACnC,MAAM,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAkB;IACrD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAyC;IAChF,OAAO,0JAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;IAC9D,iBAAiB,0JAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AACzE,GAAG,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,EAAE,eAAe,EAAE;IAC/C,MAAM;QAAC;KAAkB;IACzB,SAAS;AACb"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/lib/action/auth-action.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\"use server\";\n\nimport { login, register } from \"../api/auth\";\nimport { setAuthToken, setUserData } from \"../cookie\";\n\nexport type AuthResponse<T = any> = {\n  success: boolean;\n  message: string;\n  data?: T;\n  user?: {\n    id: string;\n    email: string;\n    name?: string;\n    role: \"admin\" | \"user\";\n  };\n};\n\n// ===== HANDLE REGISTER =====\nexport const handleRegister = async (formData: any): Promise<AuthResponse> => {\n  try {\n    const res = await register(formData);\n\n    if (res.success) {\n      return {\n        success: true,\n        data: res.data,\n        message: res.message || \"Registration successful\",\n      };\n    }\n\n    return {\n      success: false,\n      message: res.message || \"Registration failed\",\n    };\n  } catch (error: any) {\n    console.error(\"Register error:\", error);\n\n    return {\n      success: false,\n      message: error.message || \"Registration failed\",\n    };\n  }\n};\n\n// ===== HANDLE LOGIN =====\nexport const handleLogin = async (formData: any): Promise<AuthResponse> => {\n  try {\n    const res = await login(formData);\n\n    console.log(\"Backend login response:\", res);\n\n    if (!res.success) {\n      return {\n        success: false,\n        message: res.message || \"Login failed\",\n      };\n    }\n\n    // ✅ token is in res.token (your backend response)\n    const token = res.token;\n\n    if (!token) {\n      return {\n        success: false,\n        message: \"Token missing from backend response\",\n      };\n    }\n\n    // ✅ Save token + user in cookies\n    await setAuthToken(token);\n    await setUserData(res.data);\n\n    return {\n      success: true,\n      data: res.data,\n      message: res.message || \"Login successful\",\n      user: {\n        id: res.data?._id,\n        email: res.data?.email,\n        name: res.data?.username || res.data?.name,\n        role: res.data?.role || \"user\",\n      },\n    };\n  } catch (error: any) {\n    console.error(\"Login error:\", error);\n\n    return {\n      success: false,\n      message: error.message || \"Login failed\",\n    };\n  }\n};\n"],"names":[],"mappings":";;;;;;;MA8Ca,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,+CAAA"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/_components/LoginForm.tsx"],"sourcesContent":["\"use client\";\nimport Link from \"next/link\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useRouter } from \"next/navigation\";\nimport { useState, useTransition } from \"react\";\nimport { LoginData, loginSchema } from \"../schema\";\nimport { handleLogin } from \"@/lib/action/auth-action\";\n\nexport default function LoginForm() {\n  const router = useRouter();\n  const [pending, startTransition] = useTransition();\n  const [error, setError] = useState<string>(\"\");\n  \n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<LoginData>({\n    resolver: zodResolver(loginSchema),\n    mode: \"onSubmit\",\n  });\n\n  const onSubmit = async (data: LoginData) => {\n    setError(\"\");\n    try {\n      const res = await handleLogin(data);\n      console.log(\"Login response:\", res);\n      \n      if (!res.success) {\n        setError(res.message || \"Login Failed\");\n        return;\n      }\n\n      // ✅ Wait for cookies to be set server-side\n      await new Promise(resolve => setTimeout(resolve, 200));\n\n      // ✅ Use window.location for hard navigation (forces page reload with cookies)\n      if (res.user?.role === \"admin\") {\n        window.location.href = \"/admin/dashboard\";\n      } else if (res.user?.role === \"user\") {\n        window.location.href = \"/dashboard\";\n      } else {\n        window.location.href = \"/\";\n      }\n    } catch (err: any) {\n      console.error(\"Login error:\", err);\n      setError(err?.message || \"Login Failed\");\n    }\n  };\n\n  return (\n    <form\n      onSubmit={handleSubmit(onSubmit)}\n      className=\"space-y-6 p-6 bg-white rounded-lg shadow-md w-full max-w-md mx-auto\"\n    >\n      {error && <p className=\"text-sm text-red-600\">{error}</p>}\n      \n      {/* Email */}\n      <div className=\"space-y-1\">\n        <label htmlFor=\"email\" className=\"text-sm font-medium\">\n          Email\n        </label>\n        <input\n          id=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          placeholder=\"shreesha@gmail.com\"\n          className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n          {...register(\"email\")}\n        />\n        {errors.email && (\n          <p className=\"text-xs text-red-600\">{errors.email.message}</p>\n        )}\n      </div>\n\n      {/* Password */}\n      <div className=\"space-y-1\">\n        <label htmlFor=\"password\" className=\"text-sm font-medium\">\n          Password\n        </label>\n        <input\n          id=\"password\"\n          type=\"password\"\n          autoComplete=\"current-password\"\n          placeholder=\"*****\"\n          className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n          {...register(\"password\")}\n        />\n        {errors.password && (\n          <p className=\"text-xs text-red-600\">{errors.password.message}</p>\n        )}\n      </div>\n\n      {/* Submit Button */}\n      <button\n        type=\"submit\"\n        disabled={pending}\n        className=\"h-10 w-full rounded-md bg-pink-400 text-white text-sm font-semibold hover:bg-pink-500 disabled:opacity-60\"\n      >\n        {pending ? \"Logging in...\" : \"Log in\"}\n      </button>\n\n      {/* Register Link */}\n      <div className=\"mt-2 text-center text-sm text-gray-600\">\n        Don&apos;t have an account?{\" \"}\n        <Link\n          href=\"/register\"\n          className=\"font-semibold text-pink-400 hover:underline\"\n        >\n          Sign up\n        </Link>\n      </div>\n    </form>\n  );\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;;AASe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,SAAS,gBAAgB,GAAG,IAAA,8KAAa;IAChD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAS;IAE3C,MAAM,EACJ,QAAQ,EACR,YAAY,EACZ,WAAW,EAAE,MAAM,EAAE,EACtB,GAAG,IAAA,4KAAO,EAAY;QACrB,UAAU,IAAA,gLAAW,EAAC,kJAAW;QACjC,MAAM;IACR;IAEA,MAAM,WAAW,OAAO;QACtB,SAAS;QACT,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,8KAAW,EAAC;YAC9B,QAAQ,GAAG,CAAC,mBAAmB;YAE/B,IAAI,CAAC,IAAI,OAAO,EAAE;gBAChB,SAAS,IAAI,OAAO,IAAI;gBACxB;YACF;YAEA,2CAA2C;YAC3C,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;YAEjD,8EAA8E;YAC9E,IAAI,IAAI,IAAI,EAAE,SAAS,SAAS;gBAC9B,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB,OAAO,IAAI,IAAI,IAAI,EAAE,SAAS,QAAQ;gBACpC,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB,OAAO;gBACL,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;QACF,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC,gBAAgB;YAC9B,SAAS,KAAK,WAAW;QAC3B;IACF;IAEA,qBACE,6LAAC;QACC,UAAU,aAAa;QACvB,WAAU;;YAET,uBAAS,6LAAC;gBAAE,WAAU;0BAAwB;;;;;;0BAG/C,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,SAAQ;wBAAQ,WAAU;kCAAsB;;;;;;kCAGvD,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,cAAa;wBACb,aAAY;wBACZ,WAAU;wBACT,GAAG,SAAS,QAAQ;;;;;;oBAEtB,OAAO,KAAK,kBACX,6LAAC;wBAAE,WAAU;kCAAwB,OAAO,KAAK,CAAC,OAAO;;;;;;;;;;;;0BAK7D,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,SAAQ;wBAAW,WAAU;kCAAsB;;;;;;kCAG1D,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,cAAa;wBACb,aAAY;wBACZ,WAAU;wBACT,GAAG,SAAS,WAAW;;;;;;oBAEzB,OAAO,QAAQ,kBACd,6LAAC;wBAAE,WAAU;kCAAwB,OAAO,QAAQ,CAAC,OAAO;;;;;;;;;;;;0BAKhE,6LAAC;gBACC,MAAK;gBACL,UAAU;gBACV,WAAU;0BAET,UAAU,kBAAkB;;;;;;0BAI/B,6LAAC;gBAAI,WAAU;;oBAAyC;oBAC1B;kCAC5B,6LAAC,0KAAI;wBACH,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT;GA1GwB;;QACP,kJAAS;QACW,8KAAa;QAO5C,4KAAO;;;KATW"}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["\"use client\";\n\nimport LoginForm from \"../_components/LoginForm\";\n\n\n\n\nexport default function Page() {\n  return (\n    <div>\n      \n      <p className=\"text-center m-0 text-3xl\">Welcome Back</p>\n      <LoginForm />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAOe,SAAS;IACtB,qBACE,6LAAC;;0BAEC,6LAAC;gBAAE,WAAU;0BAA2B;;;;;;0BACxC,6LAAC,iKAAS;;;;;;;;;;;AAGhB;KARwB"}}]
}