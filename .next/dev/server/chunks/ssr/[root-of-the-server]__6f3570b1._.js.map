{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/schema.ts"],"sourcesContent":["import z from \"zod\";\n\nexport const loginSchema = z.object({\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n});\n\nexport type LoginData = z.infer<typeof loginSchema>;\n\nexport const registerSchema = z.object({\n    name: z.string().min(2, { message: \"Enter your name\" }),\n    username: z.string().min(3, { message: \"Username must be at least 3 characters\" }),\n    email: z.string().email({ message: \"Enter a valid email\" }),\n    password: z.string().min(6, { message: \"Minimum 6 characters\" }),\n    confirmPassword: z.string().min(6, { message: \"Minimum 6 characters\" }),\n}).refine((v) => v.password === v.confirmPassword, {\n    path: [\"confirmPassword\"],\n    message: \"Passwords do not match\",\n});\n\nexport type RegisterData = z.infer<typeof registerSchema>;"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,cAAc,uJAAC,CAAC,MAAM,CAAC;IAChC,OAAO,uJAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,uJAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AAClE;AAIO,MAAM,iBAAiB,uJAAC,CAAC,MAAM,CAAC;IACnC,MAAM,uJAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAkB;IACrD,UAAU,uJAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAyC;IAChF,OAAO,uJAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QAAE,SAAS;IAAsB;IACzD,UAAU,uJAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;IAC9D,iBAAiB,uJAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAAE,SAAS;IAAuB;AACzE,GAAG,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,EAAE,eAAe,EAAE;IAC/C,MAAM;QAAC;KAAkB;IACzB,SAAS;AACb"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/lib/action/auth-action.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\"use server\";\nimport { login, register } from \"../api/auth\";\nimport { setAuthToken, setUserData } from \"../cookie\";\n\nexport type AuthResponse<T = any> = {\n  success: boolean;\n  message: string;\n  data?: T;\n  user?: {\n    id: string;\n    email: string;\n    name?: string;\n    role: \"admin\" | \"user\";\n  };\n};\n\n// ===== HANDLE REGISTER =====\nexport const handleRegister = async (formData: any): Promise<AuthResponse> => {\n  try {\n    // send data to backend API\n    const res = await register(formData);\n    if (res.success) {\n      // optionally, you could also set cookie after register if needed\n      // e.g., automatically log in after register\n      return {\n        success: true,\n        data: res.data,\n        message: \"Registration successful\",\n      };\n    }\n    return { success: false, message: res.message || \"Registration failed\" };\n  } catch (error: Error | any) {\n    console.error(\"Register error:\", error);\n    return { success: false, message: error.message || \"Registration failed\" };\n  }\n};\n\n// ===== HANDLE LOGIN =====\nexport const handleLogin = async (formData: any): Promise<AuthResponse> => {\n  try {\n    const res = await login(formData);\n    \n    console.log(\"Backend login response:\", res); // Debug log\n    \n    if (res.success) {\n      const token = res.token;\n      \n      // store JWT token in cookie\n      await setAuthToken(token);\n      \n      // store user data in cookie\n      await setUserData(res.data);\n      \n      // âœ… Return user data with role for redirect logic\n      return {\n        success: true,\n        data: res.data,\n        message: \"Login successful\",\n        user: {\n          id: res.data?.id || res.data?._id,\n          email: res.data?.email,\n          name: res.data?.name,\n          role: res.data?.role || \"user\", // Get role from backend response\n        },\n      };\n    }\n    return { success: false, message: res.message || \"Login failed\" };\n  } catch (error: Error | any) {\n    console.error(\"Login error:\", error);\n    return { success: false, message: error.message || \"Login failed\" };\n  }\n};"],"names":[],"mappings":";;;;;;;MAuCa,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,+CAAA"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/_components/LoginForm.tsx"],"sourcesContent":["// \"use client\";\n\n// import Link from \"next/link\";\n// import { useForm } from \"react-hook-form\";\n// import { zodResolver } from \"@hookform/resolvers/zod\";\n// import { useRouter } from \"next/navigation\";\n// import { useState, useTransition } from \"react\";\n\n// import { LoginData, loginSchema } from \"../schema\";\n// import { handleLogin } from \"@/lib/action/auth-action\";\n\n// export default function LoginForm() {\n//   const router = useRouter();\n//   const [pending, startTransition] = useTransition();\n//   const [error, setError] = useState<string>(\"\");\n\n//   const {\n//     register,\n//     handleSubmit,\n//     formState: { errors },\n//   } = useForm<LoginData>({\n//     resolver: zodResolver(loginSchema),\n//     mode: \"onSubmit\",\n//   });\n\n//   const onSubmit = async (data: LoginData) => {\n//     setError(\"\");\n//     try {\n//       const res = await handleLogin(data);\n//       if (!res.success) {\n//         throw new Error(res.message || \"Login Failed\");\n//       }\n//       startTransition(() => {\n//         router.push(\"/dashboard\");\n//       });\n//     } catch (err: any) {\n//       setError(err?.message || \"Login Failed\");\n//     }\n//   };\n\n//   return (\n//     <form\n//       onSubmit={handleSubmit(onSubmit)}\n//       className=\"space-y-6 p-6 bg-white rounded-lg shadow-md w-full max-w-md mx-auto\"\n//     >\n//       {error && <p className=\"text-sm text-red-600\">{error}</p>}\n\n//       {/* Email */}\n//       <div className=\"space-y-1\">\n//         <label htmlFor=\"email\" className=\"text-sm font-medium\">\n//           Email\n//         </label>\n//         <input\n//           id=\"email\"\n//           type=\"email\"\n//           autoComplete=\"email\"\n//           placeholder=\"shreesha@gmail.com\"\n//           className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n//           {...register(\"email\")}\n//         />\n//         {errors.email && (\n//           <p className=\"text-xs text-red-600\">{errors.email.message}</p>\n//         )}\n//       </div>\n\n//       {/* Password */}\n//       <div className=\"space-y-1\">\n//         <label htmlFor=\"password\" className=\"text-sm font-medium\">\n//           Password\n//         </label>\n//         <input\n//           id=\"password\"\n//           type=\"password\"\n//           autoComplete=\"current-password\"\n//           placeholder=\"*****\"\n//           className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n//           {...register(\"password\")}\n//         />\n//         {errors.password && (\n//           <p className=\"text-xs text-red-600\">{errors.password.message}</p>\n//         )}\n//       </div>\n\n//       {/* Submit Button */}\n//       <button\n//         type=\"submit\"\n//         disabled={pending}\n//         className=\"h-10 w-full rounded-md bg-pink-400 text-white text-sm font-semibold hover:bg-pink-500 disabled:opacity-60\"\n//       >\n//         {pending ? \"Logging in...\" : \"Log in\"}\n//       </button>\n\n//       {/* Register Link */}\n//       <div className=\"mt-2 text-center text-sm text-gray-600\">\n//         Don&apos;t have an account?{\" \"}\n//         <Link\n//           href=\"/register\"\n//           className=\"font-semibold text-pink-400 hover:underline\"\n//         >\n//           Sign up\n//         </Link>\n//       </div>\n//     </form>\n//   );\n// }\n\n\"use client\";\n\nimport Link from \"next/link\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useRouter } from \"next/navigation\";\nimport { useState, useTransition } from \"react\";\nimport { LoginData, loginSchema } from \"../schema\";\nimport { handleLogin } from \"@/lib/action/auth-action\";\n\nexport default function LoginForm() {\n  const router = useRouter();\n  const [pending, startTransition] = useTransition();\n  const [error, setError] = useState<string>(\"\");\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<LoginData>({\n    resolver: zodResolver(loginSchema),\n    mode: \"onSubmit\",\n  });\n\n  const onSubmit = async (data: LoginData) => {\n    setError(\"\");\n    try {\n      const res = await handleLogin(data);\n      \n      // Debug: Log the response to see what we're getting\n      console.log(\"Login response:\", res);\n      \n      if (!res.success) {\n        throw new Error(res.message || \"Login Failed\");\n      }\n\n      // Role-based redirect\n      startTransition(() => {\n        if (res.user?.role === \"admin\") {\n          router.push(\"/admin/dashboard\");\n        } else {\n          router.push(\"/dashboard\");\n        }\n      });\n      \n    } catch (err: any) {\n      console.error(\"Login error:\", err);\n      setError(err?.message || \"Login Failed\");\n    }\n  };\n\n  return (\n    <form\n      onSubmit={handleSubmit(onSubmit)}\n      className=\"space-y-6 p-6 bg-white rounded-lg shadow-md w-full max-w-md mx-auto\"\n    >\n      {error && <p className=\"text-sm text-red-600\">{error}</p>}\n\n      {/* Email */}\n      <div className=\"space-y-1\">\n        <label htmlFor=\"email\" className=\"text-sm font-medium\">\n          Email\n        </label>\n        <input\n          id=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          placeholder=\"shreesha@gmail.com\"\n          className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n          {...register(\"email\")}\n        />\n        {errors.email && (\n          <p className=\"text-xs text-red-600\">{errors.email.message}</p>\n        )}\n      </div>\n\n      {/* Password */}\n      <div className=\"space-y-1\">\n        <label htmlFor=\"password\" className=\"text-sm font-medium\">\n          Password\n        </label>\n        <input\n          id=\"password\"\n          type=\"password\"\n          autoComplete=\"current-password\"\n          placeholder=\"*****\"\n          className=\"h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 text-sm outline-none focus:border-pink-400 focus:ring-1 focus:ring-pink-400\"\n          {...register(\"password\")}\n        />\n        {errors.password && (\n          <p className=\"text-xs text-red-600\">{errors.password.message}</p>\n        )}\n      </div>\n\n      {/* Submit Button */}\n      <button\n        type=\"submit\"\n        disabled={pending}\n        className=\"h-10 w-full rounded-md bg-pink-400 text-white text-sm font-semibold hover:bg-pink-500 disabled:opacity-60\"\n      >\n        {pending ? \"Logging in...\" : \"Log in\"}\n      </button>\n\n      {/* Register Link */}\n      <div className=\"mt-2 text-center text-sm text-gray-600\">\n        Don&apos;t have an account?{\" \"}\n        <Link\n          href=\"/register\"\n          className=\"font-semibold text-pink-400 hover:underline\"\n        >\n          Sign up\n        </Link>\n      </div>\n    </form>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 353, "column": 0}, "map": {"version":3,"sources":["file:///Users/shreeshashrestha/Desktop/untitled%20folder/Flower%20Bloosom%20web/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["\"use client\";\n\nimport LoginForm from \"../_components/LoginForm\";\n\n\n\n\nexport default function Page() {\n  return (\n    <div>\n      \n      <p className=\"text-center m-0 text-3xl\">Welcome Back</p>\n      <LoginForm />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAOe,SAAS;IACtB,qBACE,8OAAC;;0BAEC,8OAAC;gBAAE,WAAU;0BAA2B;;;;;;0BACxC,8OAAC,8JAAS;;;;;;;;;;;AAGhB"}}]
}